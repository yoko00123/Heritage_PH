define(["app"],function(n){var t=function(n,t,i,r,u,f,e){var o,s,h;t("BaseController",{$scope:n});n.InfoGUID=vcl.Random.GUID().replace(/-/g,"");n.g=r.group(n.InfoGUID);n.SetController("Info");n.data={Title:null,Row:{},Combos:{},HasChanges:!1,RowCondition:{}};n.ReportTab={Name:"Undefined"};n.Status="Preparing";n.StatusColor=1;n.detail=[];n.newHash=null;n.NoTransactionTables=[];n.InfoTabFields=null;n.FormLoad=function(){};n.CanSave=function(){return n.Task()};n.BeforeSave=function(){return n.Task()};n.AfterSave=function(){return n.Task()};n.AfterInit=function(){return n.Task()};n.AfterLoadData=function(){return n.Task()};n.OnAfterDocumentDefault=function(){return n.Task()};n.IsAllowEdit=!0;n.IsAllowNew=!0;n.canViewEmployeeSalary=!1;n.InitInfoSet=function(t){n.rInit();n.PrepareRowSchema();n.canViewEmployeeSalary=n.Session("CanViewEmployeeSalary");n.data.Title=n.tMenu.Name;n.data.Row.ID=t||f;n.DetailRegistered=[];n.RebuildTabs();n.AfterInit().then(function(){var t=Enumerable.From(n.tMenuDetailTab).Where(function(t){return t.IsActive===!0&&t.ID_MenuDetailTabType!==4&&n.IsNull(t.ParentTableName,n.tMenu.TableName)===n.tMenu.TableName});t.Count()<=0&&n.FormLoad();setTimeout(function(){$(".side-menu").addClass("toggle-sidemenu");$(".untoggled-actions").addClass("toggle-actions");$(".bookmark-panel").removeClass("toggle-bookmark")},500);setTimeout(function(){n.ToggleInfoPanel()},1e3)})};n.rInit=function(){n.Request("rGetUserGroup",{ID_Menu:n.tMenu.ID,ID_UserGroup:n.Session("ID_UserGroup")}).then(function(t){n.IsAllowEdit=t.data[0].AllowEdit;n.IsAllowNew=t.data[0].AllowNew})};n.PrepareRowSchema=function(){var t,i,r;try{t=n.tMenuTabField;for(i in t)n.data.Row[t[i].Name]=null,t[i].Name.substr(0,3)==="ID_"&&(n.data.Row[t[i].Name.substr(3)]=null),n.data.RowCondition[t[i].Name]={WritableIf:!1,VisibleIf:!0};Enumerable.From(t).Where(function(n){return n.ShowInInfo===!0&&n.ID_SystemControlType===2}).ForEach(function(t){r=t.FixedFilter;r=n.PassParameter(r);n.data.Combos[t.Name]=[];n.LoadCombo(t.DataSource||n.StringFormat("V{0}",t.Name.substr(3)),t.Name,r,t.Sort).then(function(t){n.data.Combos[t.Name]=t.DataList;n.$apply()})});n.data.FileMenuVisible=Enumerable.From(n.Schema).Where(function(n){return n.ColumnName.toUpperCase()==="GUID"}).Any()}catch(u){console.error(u.message)}};n.DetailRegistered=[];n.g.on("InitReady",function(t){(function(){n.DetailRegistered.push(t);var i=Enumerable.From(n.tMenuDetailTab).Where(function(t){return t.IsActive===!0&&t.ID_MenuDetailTabType!==4&&n.IsNull(t.ParentTableName,n.tMenu.TableName)===n.tMenu.TableName}).Count();i==n.DetailRegistered.length?n.FormLoad():console.log(i-n.DetailRegistered.length+" Details left to be ready")})()});n.g.on("GetRow",function(){return n.data.Row});n.GetTableSchema=function(n){return Enumerable.From(i.SchemaTable).Where(function(t){return t.TableName===n}).SingleOrDefault()};n.RebuildTabs=function(){var t=[];n.tMenuTab.forEach(function(i){i.ID==178?n.canViewEmployeeSalary&&n.MenuTabFilter(i)===!0&&(i.TabType=1,t.push(i)):n.MenuTabFilter(i)===!0&&(i.TabType=1,t.push(i))});n.tMenuDetailTab.forEach(function(i){n.MenuDetailTabFilter(i)===!0&&(i.TabType=2,t.push(i))});n.InfoTabFields=Enumerable.From(t).OrderBy(function(t){return parseInt(n.IsNull(t.SeqNo,0))}).ToArray()};n.LoadData=function(t){return n.Status="Loading data",n.StatusColor=1,n.Request("LoadInfo",{ID:t||n.data.Row.ID,TableName:n.tMenu.TableName}).then(function(t){var f,i,u,r;try{n.data.Title=t.Row.ID>0?t.Row.Name||n.tMenu.Name:n.tMenu.Name;for(f in t.Columns){if(i=t.Columns[f].ColumnName,u=Enumerable.From(n.Schema).Where(function(n){return n.ColumnName==i}).FirstOrDefault(null),u!=null)switch(u.DataType){case"datetime":r=t.Row[i];r!=null&&(i.toLowerCase().indexOf("datetime")!=-1?t.Row[i]=vcl.DateTime.Format(r,vcl.DateTime.masks.inSysDateTime):i.toLowerCase().indexOf("date")!=-1&&(t.Row[i]=vcl.DateTime.Format(r,vcl.DateTime.masks.mediumDate)));break;case"decimal":t.Row[i]&&(t.Row[i]=parseFloat(t.Row[i]).toFixed(2))}n.data.Row[i]=t.Row[i]}n.data.Row.ID===0&&n.CheckDocumentDefault();n.LoadCustomParameters().then(function(){n.Status="Loaded";n.StatusColor=2;n.LoadCustomParameters();n.RefreshControls();n.g.invoke("LoadDetailData",n.data.Row,n.NoTransactionTables).then(function(){n.AfterLoadData();n.Status="Ready";n.StatusColor=2})})}catch(e){console.error("LoadData Error:",e)}})};n.SaveInfo=function(){return n.SetController("Info"),n.Status="Checking Info",n.StatusColor=1,n.CanSave().then(function(){return n.CheckDocumentDefault(),n.Status="Validating Info",n.StatusColor=1,n.ValidateInfo().then(function(){return n.BeforeSave().then(function(){var t={},i={},r={},u={},f=[];return t[n.tMenu.TableName]=n.data.Row,n.DataRowState=t[n.tMenu.TableName].ID===0?n.RowState.Inserted:n.RowState.Updated,r[n.tMenu.TableName]=n.data.Row,n.DataRowState=r[n.tMenu.TableName].ID===0?n.RowState.Inserted:n.RowState.Updated,n.g.invoke("GetDetailData",n.NoTransactionTables).then(function(e){e.forEach(function(n){n&&n.TableName.substr(0,1)==="t"&&(t[n.TableName]=n.Data,u[n.TableName]=n.Data,i[n.TableName]=n.Deleted,f.push(n.TableName))});n.Status="Saving Info";n.StatusColor=1;n.RequestID=vcl.Random.S4();n.OverlayMessage("Saving Info");n.ShowOverlay();var o=n.ByteLength(t);return o>=1e5?n.Request("SaveHeader",{ID_Menu:n.tMenu.ID,Data:r}).then(function(t){var r=[];return f.forEach(function(f){r.push(n.Request("SaveDetail",{ID_Menu:n.tMenu.ID,RowHeader:t,TableName:f,Data:u[f],RowDeleted:i[f]}))}),n.OverlayMessage("Saving Details"),$.when.apply(undefined,r).promise().then(function(){var i={CommandText:n.PassParameter(n.tMenu.SaveTrigger)||"",ID:t.ID};return n.OverlayMessage("Validating Info"),n.Request("SaveTrigger",i).then(function(){return n.HideOverlay(),n.data.HasChanges=!0,n.Status="Saved",n.StatusColor=2,n.Toast("Successfully saved!"),n.AfterSave(t.ID,n.DataRowState).then(function(){n.LoadData(t.ID)})}).fail(function(t){n.HideOverlay();n.Status=t.toString();n.StatusColor=3})}).fail(function(t){n.HideOverlay();n.Status=t.toString();n.StatusColor=3})}).fail(function(t){n.HideOverlay();n.Status=t.toString();n.StatusColor=3}):n.Request("SaveInfo",{RequestID:n.RequestID,ID_Menu:n.tMenu.ID,Data:t,SaveTrigger:n.PassParameter(n.tMenu.SaveTrigger),RowDeleted:i}).then(function(){n.CheckSaveStatusStatus()}).fail(function(t){n.Status=t.toString();n.StatusColor=3})})})})})};n.CheckSaveStatusStatus=function(){n.Request("SavingStatus",{RequestID:n.RequestID}).then(function(t){if(t.Status===0)n.OverlayMessage(t.Message),n.Task(null,1e3).then(function(){n.CheckSaveStatusStatus()});else return n.RequestID=null,n.HideOverlay(),n.data.HasChanges=!0,n.Status="Saved",n.StatusColor=2,n.Toast("Successfully saved!"),n.AfterSave(t.ID,n.DataRowState).then(function(){n.LoadData(t.ID)})}).fail(function(t){n.RequestID=null;n.HideOverlay();n.Status=t.toString();n.StatusColor=3})};n.ValidateInfo=function(){return n.Task(function(t){for(var i in n.data.Row)typeof n.data.Row[i]==typeof undefined&&(n.data.Row[i]=!1);n.g.invoke("ValidateDetailData").then(function(i){var r=[];i.forEach(function(t){t&&t.Tag&&(n.Toast(t.Name+". Field "+t.Tag.Field+" on line "+t.Tag.Line+" required","Form Validation","warning"),r.push(t))});r.length>0?t.reject():t.resolve()})})};n.CheckDocumentDefault=function(){Enumerable.From(Object.keys(n.data.Row)).Join(n.Schema,function(n){return n},function(n){return n.ColumnName},function(n,t){return t}).ForEach(function(t){try{if(n.data.Row.ID===0){var i=Enumerable.From(n.tMenuTabField).Where(function(n){return n.Name===t.ColumnName}).FirstOrDefault(null);if(t.DefaultValue=vcl.String.Trim(i&&n.IsNull(i.DefaultValue,"")!==""?i.DefaultValue:t.DefaultValue,["(",")"]),i&&n.data.Row[t.ColumnName]!==null)return;if(n.IsNull(t.DefaultValue,"")==="")return;t.ColumnName==="Date"&&(n.data.Row[t.ColumnName]=vcl.DateTime.Format(new Date,vcl.DateTime.masks.mediumDate));t.DefaultValue.substr(0,1)==="@"?(n.data.Row[t.ColumnName]=n.PassParameter(t.DefaultValue),n.data.Row[t.ColumnName]=isNaN(n.data.Row[t.ColumnName])?n.data.Row[t.ColumnName]:parseFloat(n.data.Row[t.ColumnName]),t.DefaultValue.toLowerCase()==="@currentdate"&&(n.data.Row[t.ColumnName]=vcl.DateTime.Format(new Date,vcl.DateTime.masks.mediumDate))):n.data.Row[t.ColumnName]=t.DataType==="bit"?parseInt(t.DefaultValue)===1?!0:!1:t.DataType==="datetime"&&t.DefaultValue==="getdate"?vcl.DateTime.ShortDate2():isNaN(t.DefaultValue)?t.DefaultValue:parseFloat(t.DefaultValue)}}catch(r){console.error("Row Default Value: "+t.ColumnName,r)}});n.$apply();n.OnAfterDocumentDefault()};n.LoadCustomParameters=function(){var i=n.tMenuLoadParameters||[],t;return i.length>0?(t={},i.forEach(function(i){t[i.Name]=n.PassParameter(n.PassParameter(i.CommandText),n.data.Row,["$","@"])}),n.Request("LoadCustomParameters",{Param:t}).then(function(t){n.data.CustomParameter=t})):n.Task()};n.RefreshControls=function(){var t=[n.data.Row];try{Enumerable.From(n.tMenuButton).ForEach(function(i){var u=!i.DisabledOnNewInfo||n.data.Row.ID!==0,r=!0;n.IsNull(i.WebEnabledIf,"")!==""&&(r=Enumerable.From(t).Where(n.PassParameter(n.PassParameter(i.WebEnabledIf),n.data.CustomParameter,":")).Any());i.Enabled=u&&r});n.EnableSave=!0;n.tMenu.EnableSaveIf&&(n.EnableSave=n.tMenu.EnableSaveIf.indexOf(":")>=0?!Enumerable.From(t).Where(n.PassParameter(n.PassParameter(n.tMenu.EnableSaveIf),n.data.CustomParameter,":")).Any():Enumerable.From(t).Where(n.tMenu.EnableSaveIf).Any())}catch(i){n.Toast(i.message,"Refresh Controls","error");console.error("Enable Buttons",i)}try{Enumerable.From(n.tMenuTabField).Where(function(t){return n.IsNull(t.WebWritableIf,"")!==""}).ForEach(function(i){n.data.RowCondition[i.Name].WritableIf=!Enumerable.From(t).Where(n.PassParameter(i.WebWritableIf)).Any()});Enumerable.From(n.tMenuTabField).Where(function(t){return n.IsNull(t.VisibleIf,"")!==""}).ForEach(function(i){n.data.RowCondition[i.Name].VisibleIf=Enumerable.From(t).Where(n.PassParameter(n.PassParameter(i.VisibleIf),n.data.CustomParameter,":")).Any()})}catch(i){n.Toast(i.message,"Refresh Controls","error")}n.g.invoke("RefreshDetailControls",n.data.Row)};n.AllowNew=function(){return!(n.tMenu.AllowNew&&n.data.Row.ID!==0)};n.AllowNewFromList=function(){return n.tMenu.AllowNewFromList};n.AllowEdit=function(){return!n.tMenu.AllowOpen};n.Cancel=function(){var t,i,r,f;n.tMenuDetailTab.forEach(function(t){n.g.clear(t.ID)});t=LZString.decompressFromEncodedURIComponent(u.params.r);t.split("-").length>2&&t.indexOf(":")==-1?(i=LZString.decompressFromEncodedURIComponent(u.params.r).split("-")[2].replace("%20","-"),r=LZString.decompressFromEncodedURIComponent(u.params.r).split("-")[3],u.go("List",{Name:i,r:LZString.compressToEncodedURIComponent(r.toString())})):(f=t.split("-")[2],f!=undefined?u.go("DirectReport",{Name:"DirectReport",r:LZString.compressToEncodedURIComponent("3060")}):u.go("List",{Name:n.tMenu.Name.replace(/ /g,"-"),r:LZString.compressToEncodedURIComponent(n.tMenu.ID.toString())}))};n.MenuTabFilter=function(n){return n.Name.toLowerCase()!=="comment"&&n.HasTable===!0};n.MenuTabPanel=function(t){var i=Enumerable.From(n.tMenuTabField).Where(function(n){return n.ID_MenuTab===t.ID}).Max(function(n){return n.Panel});return Enumerable.Range(1,i).ToArray()};n.MenuTabFieldFilter=function(n,t){return function(i){return i.ID_MenuTab===n.ID&&i.Panel===t&&i.ShowInInfo===!0}};n.ButtonFilter=function(t){return n.IsNull(t.ID_MenuDetailTab,0)===0};n.MenuDetailTabFilter=function(t){return(n.IsNull(t.ParentTableName,"")===""||n.IsNull(t.ParentTableName,"")===n.tMenu.TableName)&&t.ID_MenuDetailTabType!==4};n.MenuDetailTabReportOnlyFilter=function(n){return n.ID_MenuDetailTabType===4};n.MDTFieldFilter=function(t){try{return Enumerable.From(n.tMenuDetailTabField).Where(function(n){return n.ID_MenuDetailTab===t.ID}).ToArray()}catch(i){console.error(i)}};n.NewInfo=function(){if(LZString.decompressFromEncodedURIComponent(u.params.r).split("-").length>2){var i=LZString.decompressFromEncodedURIComponent(u.params.r).split("-")[2].replace("%20","-"),t=LZString.decompressFromEncodedURIComponent(u.params.r).split("-")[3];u.go("Info",{Name:n.tMenu.Name.replace(/ /g,"-"),r:LZString.compressToEncodedURIComponent(n.tMenu.ID.toString()+"-0"+(LZString.decompressFromEncodedURIComponent(u.params.r).split("-").length>2?"-"+LZString.decompressFromEncodedURIComponent(u.params.r).split("-")[2]+"-"+t.toString():""))},{reload:!0})}else u.go("Info",{Name:n.tMenu.Name.replace(/ /g,"-"),r:LZString.compressToEncodedURIComponent(n.tMenu.ID.toString()+"-0")},{reload:!0})};n.btnSaveInfo=function(){var t=n.ValidateParent();t&&n.SaveInfo()};n.RefreshInfo=function(){n.LoadData()};n.PrintData=function(t){return n.CheckDocumentDefault(),n.Status="Validating Info",n.StatusColor=1,n.ValidateInfo().then(function(){var r,i={},u={};return i[n.tMenu.TableName]=n.data.Row,r=i[n.tMenu.TableName].ID===0?n.RowState.Inserted:n.RowState.Updated,n.g.invoke("GetDetailData").then(function(r){r.forEach(function(n){n&&n.TableName.substr(0,1)==="t"&&(i[n.TableName]=n.Data,u[n.TableName]=n.Deleted)});n.Status="Printing Info";n.StatusColor=1;switch(t.Type){case 1:n.Download("PrintInfo",{ID_Menu:n.tMenu.ID,Data:i,opt:t.DocType}).then(function(){n.Status="Ready";n.StatusColor=2});break;case 3:n.Dialog({template:"email.tmpl.html",controller:"EmailDialogController",size:"md"}).result.then(function(){})}})})};n.ButtonClick=function(t){try{if(t.Click){t.Click(t);return}var r=function(){return n.Request("ButtonValidateCommand",{ValidateCommandText:n.PassParameter(n.PassParameter(t.ValidateCommandText,n.data.Row,["$","@"]))})},i=function(){t.ID_MenuButtonType===3?u():n.IsNull(t.CommandText,"")!==""&&(t.IsGeneratedTextFile===!0?n.Download("GenerateText",{DefaultFileName:n.PassParameter(n.PassParameter(n.data.Row.FileName||t.DefaultFileName||t.Name),n.data.Row,"@"),CommandText:n.PassParameter(n.PassParameter(t.CommandText),n.data.Row,"@"),ID:n.data.Row.ID}):n.Request("ButtonCommand",{CommandText:n.PassParameter(n.PassParameter(t.CommandText),n.data.Row,"$",["@.ID"])}).then(function(){n.IsNull(t.SuccessInfoText,"")!==""?n.Toast(t.SuccessInfoText):n.Toast("Done");n.LoadData()}))},u=function(){var i={Name:t.Name,ID_Menu:n.tMenu.ID,ID_Record:n.data.Row.ID,ID_User:n.Session("ID_User"),CommandText:n.PassParameter(n.PassParameter(t.CommandText),n.data.Row,"$",["@.ID"]),MenuName:n.tMenu.Name};n.Request("Job_CheckQueue",i).then(function(t){t?n.Toast("The process request has been queue, the system will tell you when done."):n.Request("Job_Enqueue",i).then(function(){n.Toast("job has been queue.")})})};t.Enabled&&(n.IsNull(t.ConfirmationText,"")!==""?n.Confirm(t.ConfirmationText).then(function(){t.ValidateCommandText?r().then(function(){i()}):i()}):t.ValidateCommandText?r().then(function(){i()}):i())}catch(f){console.error(f.message)}};n.RowState={Inserted:0,Updated:1};n.ReadOnly=function(t){try{var i=Enumerable.From(n.Schema).Where(function(n){return n.ColumnName===t.Name.trim()}).SingleOrDefault(),r=!1;return t.ReadOnly===!0?r=!0:i&&(i.Identity||i.Computed)&&(r=!0),r||n.data.RowCondition[t.Name].WritableIf}catch(u){return console.error("ReadOnly: "+t.Name,u),!0}};n.Required=function(t){var i,r;try{return(i=Enumerable.From(n.Schema).Where(function(n){return n.ColumnName===t.Name.trim()}).SingleOrDefault(),i&&i.Identity)?!1:(r=!1,t.IsRequired?r=!0:i&&i.AllowDBNull===0&&(r=!0),r)}catch(u){return console.error("Required: "+t.Name,u),!1}};n.VisibleIf=function(t){var i=!0;return(t.Name==="ID"&&(i=!0),i&&n.data.RowCondition[t.Name].VisibleIf)?i:i&&n.data.RowCondition[t.Name].VisibleIf};n.GetTabButton=function(t){return Enumerable.From(n.tMenuButton).Where(function(n){return n.ID_MenuDetailTab===t.ID}).ToArray()};n.GetDetailTableField=function(t){return Enumerable.From(n.tMenuDetailTabField).Where(function(n){return n.ID_MenuDetailTab===t.ID}).ToArray()};n.UploadImage=function(t){n.UploadFile("UploadImage",null,!1,"image/*").then(function(i){n.data.Row[t]=i.GUID;n.Toast("Image Uploaded")}).fail(function(t){n.Toast(t,document.title,"warning")})};n.ToggleInfoPanel=function(){var n=$(".info-panel");n.toggleClass("info-toggled");n.hasClass("info-toggled")?($("[scroll-area]").width($("[scroll-area]").width()-200),$("#pdfViewer").width($(".info-body-container .panel-body").width()+30)):($("[scroll-area]").width($("[scroll-area]").width()+200),$("#pdfViewer").width($(".info-body-container .panel-body").width()+30))};n.ShowReportTab=function(t){n.ReportTab=t;n.PDFViewerApplication.close();n.PDFViewerApplication.SetTitle(t.Name);$(".report-body").addClass("report-body-show")};n.HideReportTab=function(){$(".report-body").removeClass("report-body-show")};n.SwitchActiveTab=function(t){n.HideReportTab();$(".tab-container").removeClass("tab-container-show");t.TabType==1?$('.tab-container[tab-type="1"]').addClass("tab-container-show"):t.TabType==2&&$('.tab-container[tab-uid="tbh_'+t.ID+'"]').addClass("tab-container-show")};n.InitialStateofTabContainer=function(){console.log("intial state loaded");$('.tab-container[tab-type="1"]').addClass("tab-container-show")};n.ClearGUID=function(){console.log("Cleared",n.InfoGUID);r.clear(n.InfoGUID)};n.g.on("ParentCurrentRow",function(t){if(n.tMenu.TableName===n.IsNull(t,n.tMenu.TableName))return n.data.Row});n.pdfSource=n.TrustSrc("/Scripts/Pack/PDFJS/web/viewer.html");n.PDFViewerApplication=null;window.pdfViewerReady=function(t,i){i.LoadButton.click(n.LoadReportClick);i.DownloadExcel.click(n.DownloadExcelClick);n.PDFViewerApplication=t};n.LoadReportClick=function(){console.log("InfoSet na LoadReport");n.LoadReport()};n.LoadReport=function(){console.log("Infoset na LoadReport d2");n.ReportTab.ReportParams=null;n.Request("LoadReportParameters",{ReportName:n.ReportTab.ReportFile}).then(function(t){t.length>0?(n.ReportTab.ReportParams=t,$(".report-param-dialog").addClass("report-param-show")):n.ShowReport()})};n.DownloadExcelClick=function(){n.DownloadExcel()};n.DownloadExcel=function(){n.ReportTab.ReportParams=null;n.Request("LoadReportParameters",{ReportName:n.ReportTab.ReportFile}).then(function(t){if(t.length>0)n.ReportTab.ReportParams=t,$(".report-param-dialog").addClass("report-param-show");else var i={ReportName:n.ReportTab.ReportFile,DataSource:n.PassParameter(n.PassParameter(n.ReportTab.DataSource,n.data.Row)),Author:n.Session("Name"),ReportParameter:n.ReportTab.ReportParams};n.Download("LoadExcelReport",i)})};n.ReportParamDialogSubmit=function(){$(".report-param-dialog").removeClass("report-param-show");n.ShowReport()};n.CloseReportParamDialog=function(){$(".report-param-dialog").removeClass("report-param-show")};n.ShowReport=function(){var t={ReportName:n.ReportTab.ReportFile,DataSource:n.PassParameter(n.PassParameter(n.ReportTab.DataSource,n.data.Row)),Author:n.Session("Name"),ReportParameter:n.ReportTab.ReportParams};n.Request("LoadReport",t).then(function(t){var i=n.convertDataURIToBinary(t.FileString);n.PDFViewerApplication.open(i)})};n.g.on("DetailOpen",function(t,i,r){n.DetailOpen(t,i,r)});n.DetailOpen=function(t,i){e.Load(n,t,i)};n.NewTable=function(t){return n.Request("NewTableSet",{ParentTableName:n.tMenu.TableName,TableName:t}).then(function(t){return t.MenuDetailTab.ID_Menu=n.tMenu.ID,t})};n.AddTable=function(t){t.MenuDetailTabField.forEach(function(t){n.tMenuDetailTabField.push(t)});i.SchemaTable.push(t.Schema);n.tMenuDetailTab.push(t.MenuDetailTab);n.RebuildTabs()};n.GetTable=function(t){return n.g.invoke("GetTable",t).then(function(n){for(var t in n)if(n[t]&&n[t]!==null)return n[t]})};n.GetButton=function(t){return Enumerable.From(n.tMenuButton).Where(function(n){return n.Name===t}).SingleOrDefault(null)};n.AddButton=function(t,i){n.tMenuButton.push({Click:i,Name:t,Enabled:!0})};n.StatusBar=function(){var t=null;return n.StatusColor==2?t="ready":n.StatusColor==3&&(t="error"),t};n.StatusFa=function(){return n.StatusColor==2?"fa-check-circle":n.StatusColor==3?"fa-exclamation-circle":"fa-circle-o-notch fa-spin"};n.View=function(n){return"v"+n.substr(1)};n.ClearThenFill=function(n,t){return $.when(n,t).then(function(n,t){n.RowData=t[0];n.UpdateView()})};n.UploadFileTab=function(t,i){n.UploadFile("UploadFileTab",null,!1,"application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/pdf,image/jpg,image/jpeg,image/png").then(function(r){r.error!=undefined?n.Toast(r.error,"danger"):(t[i]=r.OrigFileName,t[i+"_GUID"]=r.GUID,n.$apply())})};o=$(".main-content")[0].offsetTop;s=$(".main-content")[0].clientHeight;$(".info-body-container .panel-body").css("maxHeight",s-66-o);$(".info-body-container .panel-body").css("minHeight",s-66-o);h=function(){var t,r;n.Schema=n.GetTableSchema(i.Menu.tMenu.TableName).Schema;for(t in i.Menu)n[t]=i.Menu[t];for(r in n.tMenuButton)n.tMenuButton[r].Enabled=!0}();n.ValidateParent=function(){var t;return n.ParentForm.$valid?(n.ParentForm.$submitted=!0,n.ParentForm.$setPristine(),!0):(n.ParentForm.$error.required&&vcl.Array.Remove(n.ParentForm.$error.required,function(n){return n.$$element[0].type=="checkbox"?!0:!1}),n.ParentForm.$error.required)?n.ParentForm.$error.required.length>0?(t=Enumerable.From(n.ParentForm.$error.required).Select(function(n){return n.$$attr.name}).Distinct().ToArray(),t.toString().trim().substr(3),n.Toast("Affected Columns: > "+t.join(", "),"Fill all required fields!","warning"),!1):!0:n.ParentForm.$error.pattern?n.ParentForm.$error.pattern.length>0?(n.Toast("Invalid values on other fields!","SaveInfo","warning"),!1):!0:n.ParentForm.$error.maxlength&&n.ParentForm.$error.maxlength.length>0?(t=Enumerable.From(n.ParentForm.$error.maxlength).Where(function(n){return n.$$attr.name!=="ID"}).Select(function(n){return n.$$attr.name}).Distinct().ToArray(),t.length>0)?(n.Toast("Affected Columns: "+t.join(", "),"You have exceeded the max length!","warning"),!1):!0:n.ParentForm.$error.minlength?n.ParentForm.$error.minlength.length>0?(n.Toast("Minimum length not reach!","SaveInfo","warning"),!1):!0:(n.ParentForm.$submitted=!0,n.ParentForm.$setPristine(),!0)}};n.controller("InfoSet",["$scope","$controller","resources","$Invoker","$state","$info","MenuDialog",t])});